[根目录](../CLAUDE.md) > [subsample](.) > **点云预处理脚本**

# 点云预处理脚本模块文档 (subsample)

## 模块职责

该模块是一个Python脚本，用于随机采样点云数据。主要功能是将大规模点云随机采样到指定数量的点（默认60000个点），以适应后续处理算法的性能要求。

## 入口与启动

主文件：`random_sample.py`

### 运行方法
```bash
cd ./subsample
python random_sample.py
```

## 对外接口

### 输入输出格式
- **输入**: `./in/` 目录中的 `.xyz` 文件（格式：x y z nx ny nz）
- **输出**: `./out/` 目录中的 `.xyz` 文件（格式：x y z nx ny nz）

脚本会处理 `./in` 目录下的所有 `.xyz` 文件，并将采样结果保存到 `./out` 目录。

### 配置参数
- `expected_num = 60000` - 期望的输出点数（默认值）
- 可在代码中修改该参数以调整采样数量

## 关键依赖与配置

- **NumPy**: 用于数值计算和数组操作
- **SciPy**: 用于空间数据结构和算法
- Python标准库: os, sys, math

### 核心算法
- 使用 `np.random.choice()` 实现随机采样
- 支持带法线信息的点云数据 (6列：x,y,z,nx,ny,nz)
- 保持点云数据结构的完整性

## 数据模型

### 文件格式
- 支持包含法线信息的点云文件
- 每行格式: `x y z nx ny nz` (3个位置坐标 + 3个法线坐标)
- 处理NaN值，自动过滤包含NaN坐标的点

### 采样策略
- 如果点云数量少于或等于期望数量，则直接复制
- 如果点云数量超过期望数量，则进行随机采样
- 不放回采样 (replace=False)

## 测试与质量

该模块通过以下方式验证：
- 验证输出点的数量是否等于期望数量
- 验证输出点云文件的格式是否正确
- 验证NaN值处理是否正确

## 常见问题 (FAQ)

1. **采样性能**: 对于大规模点云，采样过程很快
2. **内存使用**: 一次性加载整个点云到内存，大型点云需要足够内存
3. **目录结构**: 输入文件应放在 `./in` 目录，输出文件自动生成在 `./out` 目录

## 相关文件清单

- `random_sample.py` - 随机采样主脚本
- `./in/` - 输入点云目录
- `./out/` - 输出点云目录

## 变更记录 (Changelog)

- **2025-12-15**: 模块文档创建
  - 记录了随机采样功能的实现
  - 说明了输入输出格式和使用方法